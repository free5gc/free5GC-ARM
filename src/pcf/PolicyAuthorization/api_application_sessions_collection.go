/*
 * Npcf_PolicyAuthorization Service API
 *
 * This is the Policy Authorization Service
 *
 * API version: 1.0.0
 * Generated by: OpenAPI Generator (https://openapi-generator.tech)
 */

package PolicyAuthorization

import (
	"free5gc/lib/http_wrapper"
	"free5gc/lib/openapi/models"
	"free5gc/src/pcf/pcf_handler/pcf_message"

	"github.com/cydev/zero"

	"github.com/gin-gonic/gin"
)

// PostAppSessions - Creates a new Individual Application Session Context resource
func PostAppSessions(c *gin.Context) {
	var appSessionContext models.AppSessionContext
	c.BindJSON(&appSessionContext)

	req := http_wrapper.NewRequest(c.Request, appSessionContext)
	req.Params["ReqURI"] = c.Request.RequestURI
	channelMsg := pcf_message.NewHttpChannelMessage(pcf_message.EventPostAppSessions, req)

	pcf_message.SendMessage(channelMsg)
	recvMsg := <-channelMsg.HttpChannel

	HTTPResponse := recvMsg.HTTPResponse
	if !zero.IsZero(HTTPResponse.Header["Location"]) {
		var appSessionId = HTTPResponse.Header["Location"][0]
		c.Header("Location", appSessionId)
		c.JSON(HTTPResponse.Status, HTTPResponse.Body)
	} else {
		c.JSON(HTTPResponse.Status, HTTPResponse.Body)
	}

}
